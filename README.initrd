
Slackware initrd mini HOWTO
by Patrick Volkerding, volkerdi@slackware.com
Fri Nov  8 21:16:06 UTC 2024

This document describes how to create and install an initrd.
Also see "man mkinitrd".

1. What is an initrd?
2. Why to I need an initrd?
3. How do I build the initrd?
4. Now that I've built an initrd, how do I use it?


1. What is an initrd?

Initrd stands for "initial ramdisk". An initial ramdisk is a very small 
Linux filesystem that is loaded into RAM and mounted as the kernel boots, 
and before the main root filesystem is mounted.

2. Why do I need an initrd?

The usual reason to use an initrd is because you need to load kernel 
modules before mounting the root partition, or because you need additional
userspace support for doing so (as with LVM). Modern Linux is practically
expected to be using an initrd, so even in cases where it *works* to boot
without one, you're probably less likely to run into bugs by using one.

3. How do I build the initrd?

Just installing the kernel package will automatically run the geninitrd
script to produce an initrd, so normally you won't need to build one --
it will be done for you. However, if you need to generate an initrd you
can do so by just running "geninitrd" which will build an initrd for the
newest kernel in /boot. You can also specify the kernel to build an initrd
for on the command line, like this:

geninitrd /boot/vmlinuz-6.11.7

If you need specific modules, or you'd like to use a different initrd
generator than Slackware's mkinitrd, or to make other adjustments, see
the /etc/default/geninitrd configuration file. You can also disable
automatic initrd generation if you don't want it.

4. Now that I've built an initrd, how do I use it?

Now that you've got an initrd (/boot/initrd.gz), you'll want to load
it along with the kernel at boot time. If you use LILO for your boot
loader you'll need to edit /etc/lilo.conf and add a line to load the
initrd. Here's an example section of lilo.conf showing how this is
done:

# Linux bootable partition config begins
image = /boot/vmlinuz-generic
  initrd = /boot/initrd-generic.img
  root = /dev/sda6
  label = Slackware
  read-only
# Linux bootable partition config ends

The initrd is loaded by the "initrd = /boot/initrd-generic.img" line.
Just add the line right below the line for the kernel image you use.
Save the file, and then run LILO again ('lilo' at the command line).
You'll need to run lilo every time you edit lilo.conf or rebuild the
initrd.

Other bootloaders also support the use of an initrd.
See the documentation for those programs for details on using an
initrd with them.


---------

Have fun!
