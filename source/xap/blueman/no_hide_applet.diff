revno: 647
committer: Valmantas Palik≈°a <walmis@balticum-tv.lt>
branch nick: trunk
timestamp: Wed 2009-12-02 21:31:16 +0200
message:
  don't force hide the applet if bluez manager is not initialized

=== modified file 'blueman/plugins/applet/StatusIcon.py'
--- blueman/plugins/applet/StatusIcon.py	2009-10-27 16:10:53 +0000
+++ blueman/plugins/applet/StatusIcon.py	2009-12-02 19:31:16 +0000
@@ -55,15 +55,16 @@
 		self.Query()
 	
 	def Query(self):
-		if not self.Applet.Manager:
-			self.props.visible = False
-			return
 			
 		rets = self.Applet.Plugins.Run("on_query_status_icon_visibility")
 		if not StatusIcon.FORCE_HIDE in rets:
 			if StatusIcon.FORCE_SHOW in rets:
 				self.props.visible = True
 			else:
+				if not self.Applet.Manager:
+					self.props.visible = False
+					return
+					
 				try:
 					if self.Applet.Manager.ListAdapters() == []:
 						self.props.visible = False
