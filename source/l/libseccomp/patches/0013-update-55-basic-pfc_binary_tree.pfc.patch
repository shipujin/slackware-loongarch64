From a41adcfbe1be9e7e81e8dbc2752a4d37f8331cc0 Mon Sep 17 00:00:00 2001
From: Xiaotian Wu <wuxiaotian@loongson.cn>
Date: Mon, 5 Feb 2024 23:13:17 +0800
Subject: [PATCH 13/16] update 55-basic-pfc_binary_tree.pfc

Signed-off-by: Shi Pujin <shipujin.t@gmail.com>
---
 tests/55-basic-pfc_binary_tree.pfc | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)

diff --git a/tests/55-basic-pfc_binary_tree.pfc b/tests/55-basic-pfc_binary_tree.pfc
index e63aa12..cca8334 100644
--- a/tests/55-basic-pfc_binary_tree.pfc
+++ b/tests/55-basic-pfc_binary_tree.pfc
@@ -178,8 +178,8 @@ if ($arch == 3221225655)
 # filter for arch loongarch64 (3221225730)
 if ($arch == 3221225730)
   if ($syscall > 62)
-    if ($syscall > 139)
-      if ($syscall > 226)
+    if ($syscall > 214)
+      if ($syscall > 4294957050)
         # filter for syscall "lstat" (4294957133) [priority: 65535]
         if ($syscall == 4294957133)
           action ERRNO(6);
@@ -192,7 +192,12 @@ if ($arch == 3221225730)
         # filter for syscall "stat" (4294957122) [priority: 65535]
         if ($syscall == 4294957122)
           action ERRNO(4);
-      else # ($syscall <= 226)
+      else # ($syscall <= 4294957050)
+        # filter for syscall "fstat" (4294957050) [priority: 65533]
+        if ($syscall == 4294957050)
+          if ($a0.hi32 == 0)
+            if ($a0.lo32 == 103)
+              action ERRNO(5);
         # filter for syscall "mprotect" (226) [priority: 65533]
         if ($syscall == 226)
           if ($a0.hi32 == 0)
@@ -204,11 +209,11 @@ if ($arch == 3221225730)
         # filter for syscall "munmap" (215) [priority: 65535]
         if ($syscall == 215)
           action ERRNO(11);
+    else # ($syscall <= 214)
+      if ($syscall > 68)
         # filter for syscall "brk" (214) [priority: 65535]
         if ($syscall == 214)
           action ERRNO(12);
-    else # ($syscall <= 139)
-      if ($syscall > 68)
         # filter for syscall "rt_sigreturn" (139) [priority: 65535]
         if ($syscall == 139)
           action ERRNO(15);
@@ -218,11 +223,6 @@ if ($arch == 3221225730)
         # filter for syscall "rt_sigaction" (134) [priority: 65535]
         if ($syscall == 134)
           action ERRNO(13);
-        # filter for syscall "fstat" (80) [priority: 65533]
-        if ($syscall == 80)
-          if ($a0.hi32 == 0)
-            if ($a0.lo32 == 103)
-              action ERRNO(5);
       else # ($syscall <= 68)
         # filter for syscall "pwrite64" (68) [priority: 65531]
         if ($syscall == 68)
-- 
2.41.0

